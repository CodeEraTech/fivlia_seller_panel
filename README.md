



{
    "store": {
        "_id": "68c24838f9cf1104714f2f23",
        "storeName": "Nomadees",
        "city": {
            "_id": "683eb89e207e54373548fa4f",
            "name": "Hisar"
        },
        "ownerName": "Goutam Kathuria",
        "PhoneNumber": "+919991374720",
        "email": "goutam.kathuria@gmail.com",
        "zone": [
            {
                "_id": "683ec96dbda160427cb853be",
                "name": "Sector 15A, Hisar, Haryana, 125001, India",
                "title": "Hisar City",
                "latitude": 29.145848762271545,
                "longitude": 75.73472849177169,
                "range": 5500
            }
        ],
        "Latitude": "29.149865655485776",
        "Longitude": "75.72629928545213",
        "status": true,
        "Authorized_Store": false,
        "Category": [],
        "aadharCard": [
            "/aadharCard/1757562935848-aadharCard.jpeg"
        ],
        "panCard": [],
        "sellFood": false,
        "fsiNumber": "",
        "fullAddress": "H NO. 43B G NO. 6, VINAY NAGAR AGWANPUR, Faridabad",
        "gstNumber": "06EPBPK1264Q1ZK",
        "emailVerified": true,
        "phoneNumberVerified": true,
        "approveStatus": "approved",
        "sellerCategories": [
            {
                "categoryId": "683ed131f6f5264ba0295759",
                "subCategories": [
                    {
                        "subCategoryId": "683eef71f6f5264ba029576e",
                        "subSubCategories": [
                            {
                                "subSubCategoryId": "6841b0a2f7ecb1f11e525823",
                                "_id": "68c3eef8d72eefaeec6e8ea3"
                            }
                        ],
                        "_id": "68c3eef8d72eefaeec6e8ea2"
                    },
                    {
                        "subCategoryId": "683ee929f6f5264ba029575d",
                        "subSubCategories": [
                            {
                                "subSubCategoryId": "6841435a8722f8e580f2f912",
                                "_id": "68c7e7a277a6c9097a7b883b"
                            }
                        ],
                        "_id": "68c7e7a077a6c9097a7b8824"
                    }
                ],
                "_id": "68c3eef8d72eefaeec6e8ea1"
            },
            {
                "categoryId": "683ee9b4f6f5264ba029575e",
                "subCategories": [
                    {
                        "subCategoryId": "683ef957f6f5264ba029577a",
                        "subSubCategories": [],
                        "_id": "68c3f04cd72eefaeec6ea7b1"
                    },
                    {
                        "subCategoryId": "683efa23f6f5264ba029577b",
                        "subSubCategories": [],
                        "_id": "68c3f04cd72eefaeec6ea7b2"
                    },
                    {
                        "subCategoryId": "683ef92bf6f5264ba0295779",
                        "subSubCategories": [],
                        "_id": "68c7be7f77a6c9097a7a8604"
                    }
                ],
                "_id": "68c3f04cd72eefaeec6ea7b0"
            },
            {
                "categoryId": "683eea03f6f5264ba029575f",
                "subCategories": [],
                "_id": "68c3f04cd72eefaeec6ea7b3"
            },
            {
                "categoryId": "683eec5ff6f5264ba0295763",
                "subCategories": [
                    {
                        "subCategoryId": "683f0296f6f5264ba029578b",
                        "subSubCategories": [],
                        "_id": "68c7b68377a6c9097a7a6c1e"
                    }
                ],
                "_id": "68c7b68377a6c9097a7a6c1d"
            },
            {
                "categoryId": "683eeb6ff6f5264ba0295760",
                "subCategories": [
                    {
                        "subCategoryId": "683ef865f6f5264ba0295774",
                        "subSubCategories": [
                            {
                                "subSubCategoryId": "68447c294ca93319eee90b83",
                                "_id": "68c7e7a677a6c9097a7b8857"
                            }
                        ],
                        "_id": "68c7e7a677a6c9097a7b8856"
                    }
                ],
                "_id": "68c7e7a677a6c9097a7b8855"
            },
            {
                "categoryId": "683eebc7f6f5264ba0295761",
                "subCategories": [
                    {
                        "subCategoryId": "683efc5df6f5264ba0295782",
                        "subSubCategories": [],
                        "_id": "68c7f43d77a6c9097a7be10b"
                    }
                ],
                "_id": "68c7f43d77a6c9097a7be10a"
            }
        ],
        "createdAt": "2025-09-11T03:55:36.756Z",
        "updatedAt": "2025-09-15T11:10:53.459Z",
        "__v": 19,
        "Description": "undefined"
    },
    "sellerAddedProducts": [
        {
            "_id": "68c29571d6ce5940d475ebe6",
            "sellerId": "68c24838f9cf1104714f2f23",
            "product_id": "684029fbb7fb40491bf4df03",
            "sell_price": 0,
            "mrp": 0,
            "status": false,
            "createdAt": "2025-09-11T09:25:05.381Z",
            "updatedAt": "2025-09-11T09:25:05.381Z",
            "__v": 0,
            "inventory": [
                {
                    "variantId": null,
                    "quantity": 0
                }
            ]
        },
        {
            "_id": "68c29571d6ce5940d475ebe9",
            "sellerId": "68c24838f9cf1104714f2f23",
            "product_id": "68403400b7fb40491bf4e1f8",
            "sell_price": 0,
            "mrp": 0,
            "status": false,
            "createdAt": "2025-09-11T09:25:05.413Z",
            "updatedAt": "2025-09-11T09:25:05.413Z",
            "__v": 0,
            "inventory": [
                {
                    "variantId": null,
                    "quantity": 0
                }
            ]
        },
        {
            "_id": "68c29571d6ce5940d475ebeb",
            "sellerId": "68c24838f9cf1104714f2f23",
            "product_id": "684034b5b7fb40491bf4e2fa",
            "sell_price": 0,
            "mrp": 0,
            "status": false,
            "createdAt": "2025-09-11T09:25:05.442Z",
            "updatedAt": "2025-09-11T09:25:05.442Z",
            "__v": 0,
            "inventory": [
                {
                    "variantId": null,
                    "quantity": 0
                }
            ]
        }
    ],
    "products": []
} 


give me full code uncut with only change i say-

import React, { useEffect, useState, useRef } from "react";
import {
  Box,
  Button,
  Grid,
  Paper,
  Typography,
  TextField,
  Switch,
  Divider,
  IconButton,
  Dialog,
  DialogTitle,
  DialogContent,
  DialogActions,
  List,
  ListItem,
  ListItemText,
  ListItemSecondaryAction,
  CircularProgress,
  Tooltip,
} from "@mui/material";
import EditIcon from "@mui/icons-material/Edit";
import DeleteIcon from "@mui/icons-material/Delete";
import AddIcon from "@mui/icons-material/Add";
import SaveIcon from "@mui/icons-material/Save";
import RoomIcon from "@mui/icons-material/Room";
import AccountBalanceIcon from "@mui/icons-material/AccountBalance";
import MDBox from "components/MDBox"; // keep your wrapper if needed
import { useMaterialUIController } from "context";
import { useNavigate } from "react-router-dom";

import L from "leaflet";
import "leaflet/dist/leaflet.css";
/**
 * Seller Profile page
 * - Shows and edits profile fields
 * - Add / edit / remove bank accounts
 * - Update address & pick lat/long on map (submits as "pending" for admin approval)
 *
 * IMPORTANT: Adjust API endpoints to match your backend.
 */

export default function SellerProfile() {
  const [controller] = useMaterialUIController();
  const { miniSidenav } = controller;
  const navigate = useNavigate();

  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [profile, setProfile] = useState(null);

const id = localStorage.getItem("sellerId");

  const [form, setForm] = useState({
    ownerName: "",
    email: "",
    PhoneNumber: "",
    gstNumber: "",
    Description: "",
    image: "",
  });

  // Bank accounts list + modal
  const [bankAccounts, setBankAccounts] = useState([]);
  const [bankDialogOpen, setBankDialogOpen] = useState(false);
  const [editingBank, setEditingBank] = useState(null); // null => add
  const [bankForm, setBankForm] = useState({
    bankName: "",
    accountHolder: "",
    accountNumber: "",
    ifsc: "",
    branch: "",
    isPrimary: false,
  });

  // Address and map
  const [address, setAddress] = useState({
    line1: "",
    city: "",
    state: "",
    postalCode: "",
    country: "",
    lat: "",
    lng: "",
    status: "approved", // approved | pending
  });
  const [addressDialogOpen, setAddressDialogOpen] = useState(false);
  const mapRef = useRef(null);
  const markerRef = useRef(null);

  // Notification
  const [message, setMessage] = useState("");

  useEffect(() => {
    fetchProfile();
  }, []);

  async function fetchProfile() {
    setLoading(true);
    try {
      const res = await fetch(`${process.env.REACT_APP_API_URL}/getSeller?id=${id}&limit=1`, {
        method: "GET",
        headers: { "Content-Type": "application/json" },
      });
      const json = await res.json();
      if (!res.ok) throw new Error(json.message || "Failed to load");

      const data = json.store || json; // adjust shape
      // Fill profile & editable form
      setProfile(data);
      setForm({
        ownerName: data.ownerName || "",
        storeName: data.storeName || "",
        email: data.email || "",
        PhoneNumber: data.PhoneNumber || "",
        gstNumber: data.gstNumber || "",
        Description: data.Description || "",
        image: data.image || "",
      });

      setBankAccounts(data.bankAccounts || data.BankAccounts || []);
      const mapA = data.Map_Api?.[0] || {};
      setAddress((prev) => ({
        ...prev,
        line1: data.address?.line1 || data.address || "",
        city: data.city || data.address?.city || "",
        state: data.state || "",
        postalCode: data.postalCode || data.zip || "",
        country: data.country || "",
        lat: data.lat ?? data.location?.lat ?? (mapA.google?.lat ?? ""),
        lng: data.lng ?? data.location?.lng ?? (mapA.google?.lng ?? ""),
        status: data.addressUpdateStatus || "approved",
      }));
    } catch (err) {
      console.error(err);
      setMessage(err.message || "Failed to fetch profile");
    } finally {
      setLoading(false);
    }
  }

  function handleFormChange(key, value) {
    setForm((p) => ({ ...p, [key]: value }));
  }

  async function handleProfileSave() {
    setSaving(true);
    try {
      // Send only allowed fields
      const formData = new FormData();
        formData.append("ownerName", form.ownerName);
        formData.append("storeName", form.storeName);
        formData.append("email", form.email);
        formData.append("PhoneNumber", form.PhoneNumber);
        formData.append("gstNumber", form.gstNumber);
        formData.append("Description", form.Description);
        if (form.image instanceof File) {
        formData.append("image", form.image);
        }

      const res = await fetch(`${process.env.REACT_APP_API_URL}/seller/profile`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: formData,
        credentials: "include",
      });

      const json = await res.json();
      if (!res.ok) throw new Error(json.message || "Save failed");

      setMessage("Profile saved");
      fetchProfile(); // refresh
    } catch (err) {
      console.error(err);
      setMessage(err.message || "Save failed");
    } finally {
      setSaving(false);
    }
  }

  // ---------------------------
  // Bank account handlers
  // ---------------------------
  function openAddBank() {
    setEditingBank(null);
    setBankForm({
      bankName: "",
      accountHolder: "",
      accountNumber: "",
      ifsc: "",
      branch: "",
      isPrimary: false,
    });
    setBankDialogOpen(true);
  }

  function openEditBank(bank) {
    setEditingBank(bank);
    setBankForm({
      bankName: bank.bankName || bank.bank || "",
      accountHolder: bank.accountHolder || bank.name || "",
      accountNumber: bank.accountNumber || bank.accNo || "",
      ifsc: bank.ifsc || "",
      branch: bank.branch || "",
      isPrimary: !!bank.isPrimary,
    });
    setBankDialogOpen(true);
  }

  async function saveBankAccount() {
    // basic validation
    if (!bankForm.bankName || !bankForm.accountHolder || !bankForm.accountNumber) {
      setMessage("Bank name, account holder and account number are required.");
      return;
    }

    try {
      setSaving(true);
      if (editingBank) {
        // update
        const res = await fetch(
          `${process.env.REACT_APP_API_URL}/seller/bank-account/${editingBank._id || editingBank.id}`,
          {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            credentials: "include",
            body: JSON.stringify(bankForm),
          }
        );
        if (!res.ok) throw new Error("Update bank failed");
      } else {
        // create
        const res = await fetch(`${process.env.REACT_APP_API_URL}/seller/bank-account`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          credentials: "include",
          body: JSON.stringify(bankForm),
        });
        if (!res.ok) throw new Error("Create bank failed");
      }

      setBankDialogOpen(false);
      setMessage("Bank saved.");
      fetchProfile(); // reload list
    } catch (err) {
      console.error(err);
      setMessage(err.message || "Bank save failed");
    } finally {
      setSaving(false);
    }
  }

  async function deleteBank(bank) {
    if (!window.confirm("Delete this bank account?")) return;
    try {
      setSaving(true);
      const res = await fetch(
        `${process.env.REACT_APP_API_URL}/seller/bank-account/${bank._id || bank.id}`,
        { method: "DELETE", credentials: "include" }
      );
      if (!res.ok) throw new Error("Delete failed");
      setMessage("Bank deleted.");
      fetchProfile();
    } catch (err) {
      console.error(err);
      setMessage(err.message || "Delete failed");
    } finally {
      setSaving(false);
    }
  }

  // ---------------------------
  // Address & Map handlers
  // ---------------------------
  function openAddressDialog() {
    setAddressDialogOpen(true);
    setTimeout(() => {
      tryInitMap();
    }, 300);
  }

  function handleAddressChange(field, value) {
    setAddress((p) => ({ ...p, [field]: value }));
  }

function tryInitMap() {
  const wrapper = document.getElementById("seller-map");
  if (!wrapper || mapRef.current) return;

  const lat = parseFloat(address.lat) || 22.5726;
  const lng = parseFloat(address.lng) || 88.3639;
  const map = L.map(wrapper).setView([lat, lng], 13);
  mapRef.current = map;

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "&copy; OpenStreetMap contributors",
  }).addTo(map);

  const marker = L.marker([lat, lng], { draggable: true }).addTo(map);
  markerRef.current = marker;

  marker.on("dragend", () => {
    const pos = marker.getLatLng();
    setAddress((p) => ({ ...p, lat: pos.lat, lng: pos.lng }));
  });

  map.on("click", (e) => {
    marker.setLatLng(e.latlng);
    setAddress((p) => ({ ...p, lat: e.latlng.lat, lng: e.latlng.lng }));
  });
}

  async function submitAddressUpdateRequest() {
    // This endpoint should create a pending request, admin must approve to apply
    try {
      setSaving(true);
      const payload = {
        address: {
          line1: address.line1,
          city: address.city,
          state: address.state,
          postalCode: address.postalCode,
          country: address.country,
        },
        lat: address.lat,
        lng: address.lng,
      };

      const res = await fetch(`${process.env.REACT_APP_API_URL}/seller/profile/address-request`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        credentials: "include",
        body: JSON.stringify(payload),
      });

      const json = await res.json();
      if (!res.ok) throw new Error(json.message || "Request failed");

      setAddress((p) => ({ ...p, status: "pending" }));
      setMessage("Address update submitted — pending admin approval.");
      setAddressDialogOpen(false);
      fetchProfile();
    } catch (err) {
      console.error(err);
      setMessage(err.message || "Failed to submit address update");
    } finally {
      setSaving(false);
    }
  }

  // ---------------------------
  // UI Rendering
  // ---------------------------
  if (loading) {
    return (
      <Box p={4} style={{ marginLeft: miniSidenav ? 80 : 250 }}>
        <CircularProgress />
      </Box>
    );
  }

  return (
    <MDBox
      p={2}
      style={{
        marginLeft: miniSidenav ? 80 : 250,
        transition: "margin-left 0.3s ease",
      }}
    >
      <Typography variant="h5" gutterBottom>
        Seller Profile
      </Typography>

      {message && (
        <Paper style={{ padding: 12, marginBottom: 12, background: "#fffbe6" }}>
          <Typography variant="body2">{message}</Typography>
        </Paper>
      )}

      <Paper style={{ padding: 16, marginBottom: 24 }}>
        <Grid container spacing={2}>
          <Grid item xs={12} md={6}>
            <Typography variant="subtitle1">Personal</Typography>
            <TextField
              label="Owner Name"
              value={form.ownerName}
              fullWidth
              margin="dense"
              onChange={(e) => handleFormChange("ownerName", e.target.value)}
            />
             <TextField
              label="Store Name"
              value={form.storeName}
              fullWidth
              margin="dense"
              onChange={(e) => handleFormChange("storeName", e.target.value)}
            />
            <TextField
              label="Owner Email"
              value={form.email}
              fullWidth
              margin="dense"
              onChange={(e) => handleFormChange("email", e.target.value)}
            />
            <TextField
              label="Mobile Number"
              value={form.PhoneNumber}
              fullWidth
              margin="dense"
              onChange={(e) => handleFormChange("PhoneNumber", e.target.value)}
            />
            <TextField
              label="GST Number"
              value={form.gstNumber}
              fullWidth
              margin="dense"
              onChange={(e) => handleFormChange("gstNumber", e.target.value)}
            />
            <TextField
              label="Image Link"
              type="file"
              fullWidth
              margin="dense"
              InputLabelProps={{ shrink: true }}
              onChange={(e) => {
                const file = e.target.files?.[0];
                if (file) {
                  // you can store just file name or full object
                  handleFormChange("image", file);
                }
              }}
              helperText="Upload image shown on product/store pages"
            />
            <TextField
              label="Description"
              value={form.Description}
              fullWidth
              margin="dense"
              multiline
              rows={3}
              onChange={(e) => handleFormChange("Description", e.target.value)}
            />
            <Box display="flex" gap={2} mt={1}>
              <Button
                variant="contained"
                color="success"
                startIcon={<SaveIcon />}
                onClick={handleProfileSave}
                disabled={saving}
              >
                {saving ? "Saving..." : "Save"}
              </Button>

              <Button variant="outlined" sx={{ color: "#a5a5a5ff"}} onClick={() => navigate(-1)}>
                Back
              </Button>
            </Box>
          </Grid>

          <Grid item xs={12} md={6}>
            <Typography variant="subtitle1" gutterBottom>
              Address
            </Typography>
            <Box display="flex" alignItems="center" gap={1}>
              <RoomIcon color="action" />
              <Box>
                <Typography variant="body2">
                  {address.line1 ? address.line1 : "No address set"}
                </Typography>
                <Typography variant="caption" color="light">
                  {address.city || ""} {address.state || ""} {address.postalCode || ""}
                </Typography>
              </Box>
            </Box>
            <Box mt={1}>
              <Button variant="outlined" sx={{ color: "#a5a5a5ff" }}onClick={openAddressDialog} startIcon={<EditIcon />}>
                Update Address / Set Location
              </Button>
              <Box mt={1}>
                <Typography variant="caption" color="textSecondary">
                  Status:{" "}
                  {address.status === "pending" ? (
                    <strong style={{ color: "#f57c00" }}>Pending admin approval</strong>
                  ) : (
                    <strong style={{ color: "#2e7d32" }}>Active</strong>
                  )}
                </Typography>
              </Box>
            </Box>
          </Grid>
        </Grid>
      </Paper>

      {/* Bank Accounts */}
      <Paper style={{ padding: 16, marginBottom: 24 }}>
        <Box display="flex" justifyContent="space-between" alignItems="center">
          <Typography variant="h6">Bank Accounts</Typography>
          <Button variant="contained" sx={{ color: "#ffffffff" }} startIcon={<AddIcon />} onClick={openAddBank}>
            Add Bank
          </Button>
        </Box>

        <List>
          {bankAccounts.length === 0 && (
            <ListItem>
              <ListItemText primary="No bank accounts added" />
            </ListItem>
          )}
          {bankAccounts.map((b) => (
            <ListItem key={b._id || b.id || b.accountNumber}>
              <ListItemText
                primary={`${b.bankName || b.bank} — ${b.accountHolder || b.name}`}
                secondary={`A/C: ${b.accountNumber} • IFSC: ${b.ifsc || "-"}`}
              />
              <ListItemSecondaryAction>
                {b.isPrimary && (
                  <Tooltip title="Primary account">
                    <AccountBalanceIcon color="primary" style={{ marginRight: 8 }} />
                  </Tooltip>
                )}
                <IconButton edge="end" onClick={() => openEditBank(b)}>
                  <EditIcon />
                </IconButton>
                <IconButton edge="end" onClick={() => deleteBank(b)}>
                  <DeleteIcon />
                </IconButton>
              </ListItemSecondaryAction>
            </ListItem>
          ))}
        </List>
      </Paper>

      {/* Bank dialog */}
      <Dialog open={bankDialogOpen} onClose={() => setBankDialogOpen(false)} maxWidth="sm" fullWidth>
        <DialogTitle>{editingBank ? "Edit Bank Account" : "Add Bank Account"}</DialogTitle>
        <DialogContent>
          <TextField
            label="Bank Name"
            fullWidth
            margin="dense"
            value={bankForm.bankName}
            onChange={(e) => setBankForm((p) => ({ ...p, bankName: e.target.value }))}
          />
          <TextField
            label="Account Holder"
            fullWidth
            margin="dense"
            value={bankForm.accountHolder}
            onChange={(e) => setBankForm((p) => ({ ...p, accountHolder: e.target.value }))}
          />
          <TextField
            label="Account Number"
            fullWidth
            margin="dense"
            value={bankForm.accountNumber}
            onChange={(e) => setBankForm((p) => ({ ...p, accountNumber: e.target.value }))}
          />
          <TextField
            label="IFSC"
            fullWidth
            margin="dense"
            value={bankForm.ifsc}
            onChange={(e) => setBankForm((p) => ({ ...p, ifsc: e.target.value }))}
          />
          <TextField
            label="Branch"
            fullWidth
            margin="dense"
            value={bankForm.branch}
            onChange={(e) => setBankForm((p) => ({ ...p, branch: e.target.value }))}
          />
          <Box display="flex" alignItems="center" gap={1} mt={1}>
            <Switch
              checked={bankForm.isPrimary}
              onChange={(e) => setBankForm((p) => ({ ...p, isPrimary: e.target.checked }))}
            />
            <Typography variant="body2">Set as primary</Typography>
          </Box>
        </DialogContent>
        <DialogActions>
          <Button onClick={() => setBankDialogOpen(false)}>Cancel</Button>
          <Button onClick={saveBankAccount} variant="contained" sx={{ color: "#fdfdfdff"}} color="primary">
            Save
          </Button>
        </DialogActions>
      </Dialog>

      {/* Address dialog */}
      <Dialog
        open={addressDialogOpen}
        onClose={() => setAddressDialogOpen(false)}
        maxWidth="md"
        fullWidth
      >
        <DialogTitle>Update Address & Location (will be pending admin approval)</DialogTitle>
        <DialogContent>
          <Grid container spacing={2}>
            <Grid item xs={12} md={6}>
              <TextField
                label="Address Line"
                fullWidth
                margin="dense"
                value={address.line1}
                onChange={(e) => handleAddressChange("line1", e.target.value)}
              />
              <TextField
                label="City"
                fullWidth
                margin="dense"
                value={address.city}
                onChange={(e) => handleAddressChange("city", e.target.value)}
              />
              <TextField
                label="State"
                fullWidth
                margin="dense"
                value={address.state}
                onChange={(e) => handleAddressChange("state", e.target.value)}
              />
              <TextField
                label="Postal Code"
                fullWidth
                margin="dense"
                value={address.postalCode}
                onChange={(e) => handleAddressChange("postalCode", e.target.value)}
              />
              <TextField
                label="Country"
                fullWidth
                margin="dense"
                value={address.country}
                onChange={(e) => handleAddressChange("country", e.target.value)}
              />

              <Box mt={2}>
                <Typography variant="subtitle2">Latitude / Longitude</Typography>
                <Box display="flex" gap={1}>
                  <TextField
                    label="Latitude"
                    value={address.lat}
                    onChange={(e) => handleAddressChange("lat", e.target.value)}
                  />
                  <TextField
                    label="Longitude"
                    value={address.lng}
                    onChange={(e) => handleAddressChange("lng", e.target.value)}
                  />
                </Box>
                <Typography variant="caption" color="textSecondary">
                  Tip: If Google Maps is loaded on the page, you can pick a location on the map. Otherwise enter lat/lng manually.
                </Typography>
              </Box>
            </Grid>

            <Grid item xs={12} md={6}>
              <Typography variant="subtitle2">Pick location on map</Typography>
              <div
                id="seller-map"
                style={{
                  height: 300,
                  width: "100%",
                  borderRadius: 6,
                  border: "1px solid #ddd",
                  marginTop: 8,
                }}
              >
                {/* Map will render here if google maps is loaded */}
                {!window.google && (
                  <Box p={2} height="100%" display="flex" alignItems="center">
                    <Typography variant="body2" color="textSecondary">
                      Google Maps not loaded — enter coordinates manually or include Google Maps JS script in your index.html.
                    </Typography>
                  </Box>
                )}
              </div>
              <Box mt={1} display="flex" gap={1}>
                <Button
                  variant="outlined"
                  sx={{ color: "#a5a5a5ff"}}
                    onClick={() => {
                    if (markerRef.current) {
                      const pos = markerRef.current.getLatLng();
                      setAddress((p) => ({ ...p, lat: pos.lat, lng: pos.lng }));
                    } else {
                      setMessage("Marker not available");
                    }
                  }}
                >
                  Use Marker Coords
                </Button>
                <Button
                  variant="contained"
                  sx={{ color: "#ffffffff"}}
                   onClick={() => {
                  if (mapRef.current && address.lat && address.lng) {
                    const lat = parseFloat(address.lat);
                    const lng = parseFloat(address.lng);
                    mapRef.current.setView([lat, lng], mapRef.current.getZoom());
                    if (markerRef.current) markerRef.current.setLatLng([lat, lng]);
                  }
                }}
                >
                  Center map
                </Button>
              </Box>
            </Grid>
          </Grid>
        </DialogContent>
        <DialogActions>
          <Button onClick={() => setAddressDialogOpen(false)}>Cancel</Button>
          <Button
            onClick={submitAddressUpdateRequest}
            variant="contained"
            sx={{ color: "#ffffffff" }}
            color="primary"
            startIcon={<SaveIcon />}
            disabled={saving}
          >
            {saving ? "Submitting..." : "Submit for Approval"}
          </Button>
        </DialogActions>
      </Dialog>
    </MDBox>
  );
}